<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
    <svg style="max-width: 70px;" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
    viewBox="0 0 1709 735" enable-background="new 0 0 1709 735" xml:space="preserve">
    <polygon fill="#FF282D" points="1135.107,129.93 1135.107,535.423 1256.909,535.423 1256.909,473.467 1216.659,473.467 
    1216.659,68.164 1135.095,68.175 "/>
    <path fill="#FF282D" d="M77.437,473.467h41.405V277.836H77.437v-53.801l41.405-6.809v-54.462c0-65.969,14.359-94.598,98.487-94.598
    c18.17,0,39.707,2.683,58.563,6.08l-11.176,66.314c-12.77-2.023-19.104-2.382-27.176-2.382c-29.639,0-37.133,2.957-37.133,31.916
    v47.131h61.541v60.611h-61.541v195.632h40.973v61.946l-163.941,0.017V473.467z"/>
    <path fill="#FF282D" d="M1093.617,453.889c-12.759,2.692-23.915,2.368-31.988,2.567c-33.557,0.825-30.658-10.204-30.658-41.844
    V277.836h63.873v-60.611h-63.873V68.164h-81.563v363.358c0,71.341,17.606,103.9,94.339,103.9c18.173,0,43.144-4.676,61.997-8.714
    L1093.617,453.889z"/>
    <path fill="#FF282D" d="M1600.297,473.8c17.141,0,31.023,13.625,31.023,30.768c0,17.138-13.883,30.76-31.023,30.76
    c-17.141,0-30.941-13.622-30.941-30.76C1569.357,487.425,1583.157,473.8,1600.297,473.8 M1600.297,530.493
    c14.239,0,25.837-11.688,25.837-25.925c0-14.245-11.598-25.579-25.837-25.579c-14.236,0-25.758,11.335-25.758,25.579
    C1574.54,518.804,1586.061,530.493,1600.297,530.493 M1606.01,519.682l-6.242-9.141h-4.306v9.141h-6.941v-30.239h12.651
    c7.473,0,12.133,3.782,12.133,10.468c0,4.914-2.463,8.258-6.327,9.398l7.558,10.372H1606.01z M1595.463,504.475H1601
    c3.168,0,5.276-1.229,5.276-4.563c0-3.165-2.109-4.402-5.104-4.402h-5.71V504.475z"/>
    <path fill="#FF282D" d="M847.593,277.725v-10.851c-24.675-4.501-49.178-4.566-62.47-4.566c-37.957,0-42.585,20.129-42.585,31.04
    c0,15.436,5.267,23.782,46.388,32.773c60.107,13.494,120.473,27.573,120.473,102.104c0,70.682-36.377,107.198-112.947,107.198
    c-51.238,0-100.954-10.999-138.888-20.625v-60.909h61.764l-0.036,10.821c26.579,5.134,54.448,4.62,68.997,4.62
    c40.487,0,47.037-21.767,47.037-33.34c0-16.061-11.611-23.774-49.562-31.47c-71.5-12.217-128.244-36.628-128.244-109.257
    c0-68.746,45.979-95.714,122.55-95.714c51.875,0,91.318,8.045,129.272,17.676v60.5H847.593z"/>
    <path fill="#FF282D" d="M472.333,331.263l-6.207-6.209l-31.522,27.47c-1.591-0.57-3.293-0.897-5.071-0.897
    c-8.506,0-15.392,7.089-15.392,15.824c0,8.745,6.886,15.832,15.392,15.832c8.502,0,15.404-7.087,15.404-15.832
    c0-1.659-0.252-3.257-0.713-4.76L472.333,331.263z"/>
    <path fill="#FF282D" d="M597.261,453.889l-0.053-253.81h-81.562v23.802c-16.799-10.078-35.511-17.285-55.455-20.979h0.461v-28.166
    h9.951v-20.714h-82.125v20.714h9.95v28.166h0.566c-78.009,14.361-137.126,82.671-137.126,164.833
    c0,92.595,75.062,167.657,167.657,167.657c31.602,0,61.155-8.755,86.385-23.955l14.694,23.986h86.152v-81.535H597.261z
    M434.41,453.704v-9.588h-9.772v9.561c-43.775-2.551-78.789-37.721-81.073-81.567h9.713v-9.772h-9.663
    c2.596-43.542,37.466-78.378,81.023-80.917v9.61h9.772v-9.638c42.935,2.295,77.52,35.973,81.257,78.51v2.802h-9.791v9.772h9.793
    l0.001,2.676C511.953,417.71,477.359,451.409,434.41,453.704z"/>
    <path fill="#FF282D" d="M1463.34,217.225h168.223v60.552h-40.209l-103.17,253.82c-29.569,71.3-78.136,138.408-152.102,138.408
    c-18.186,0-42.396-2.015-59.185-6.049l7.377-74.028c10.773,2.015,24.884,3.341,32.288,3.341c34.301,0,72.993-21.253,85.094-58.257
    l-104.536-257.233h-40.211v-60.552h168.31v60.552h-40.205l59.223,145.702l0,0l59.223-145.702h-40.121V217.225z"/>
    </svg>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <script>
    function isValueValid(inputtxt) {
        //var regex = /^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
        /*var regex = /([\W_])+/;
        if(!regex.test(value)) {
           return false;
        } else{
           return true;
        }*/
        var letters = /^[0-9a-zA-Z_\.\-\+]+$/;
        if(inputtxt.value.match(letters))
        {
          return true;
        } else {
          google.script.run.showAlert("Please enter alphanumeric values only for Customer ID and Fastly Key");
        }
      }  
    </script>
  </head>
  <body>
    <form id="myform">
    <div class="block form-group">
    <label for="customer_id">Customer ID</label>
    <input type='text' name='customer_id' id="customer_id" required="required"/>
    </div>
    
    <div class="block form-group">
    <label for="fastly_key">Fastly API Key (Pls don't share it with anyone) </label>
    <input type='text' name='fastly_key' id="fastly_key" required="required"/>
    </div>

    <div class="block form-group">
    <label for="acc_certData">Fetch Certificate Info? </label>
    <input type='checkbox' name='acc_certData' id="acc_certData" />
    </div>
    
    <div class="block form-group">
    <label for="fastly_svc_id">Specific service id if you know it (Comma separated with space e.g. id1, id2..)</label>
    <input type='text' name='fastly_svc_id' id="fastly_svc_id"/>
    </div>
    
    <p> You can choose to leave from to service number fields blank to pull all services info</p>

    <div class="block form-group">
    <label for="svc_no_from">From service number (e.g. 1, 2, etc. Fastly sorts it alphanumerically in Admin UI)</label>
    <input type='number' min= "1" name='svc_no_from' id="svc_no_from" />
    </div>
    
    <div class="block form-group">
    <label for="svc_no_to">To service number (Has to be >= 'From' service number)</label>
    <input type='number' min= "1" name='svc_no_to' id="svc_no_to" />
    </div>
    
    <p> Default resulting stats for past 90 days usage </p>
    
    <div class="block form-group">
    <label for="svc_id_from">Service Stats From date </label>
    <!--- <input type='date' name='svc_id_from' id="svc_id_from" pattern="\d{4}-\d{2}-\d{2}"/> --->
    <input type='date' name='svc_id_from' id="svc_id_from" data-date="" data-date-format="MM DD YYYY" />
    </div>

    <div class="block form-group">
    <label for="svc_id_to">Service Stats To date </label>
    <!--- <input type='date' name='svc_id_to' id="svc_id_to" pattern="\d{4}-\d{2}-\d{2}"/> --->
    <input type='date' name='svc_id_to' id="svc_id_to" data-date="" data-date-format="MM DD YYYY" />
    </div>
    
    <p> Billing will return no info if not available. Default is MTD invoice 3 months ago </p>

    <div class="block form-group">
    <label for="svc_billingMonth">Billing month </label>
     <input type='number' name='svc_billingMonth' id="svc_billingMonth" min="1" max="12"/>
    </div>
    
    <div class="block form-group">
    <label for="svc_billingYear">Billing year </label>
    <input type='number' name='svc_billingYear' id="svc_billingYear" min="2008" />
    </div>
    
    <div class="block form-group">
    <label for="regions">Choose a region (Optional - default is all) :</label>
    <select name="region" id="region">
      <option value="all">All</option>
      <option value="africa_std">Africa</option>
      <option value="anzac">Australia and New Zealand</option>
      <option value="asia">Asia</option>
      <option value="asia_india">India</option>
      <option value="europe">Europe</option>
      <option value="latam">Latin America</option>
      <option value="southamerica_std">South America</option>
      <option value="usa">USA</option>
    </select>
    </div>
     
    <div class="block">
    <button type="submit" class="action">Submit</button>
    </div>
 
    </form>
    <script>
    document.querySelector("#myform").addEventListener("submit", 
    function(e)
    {
    e.preventDefault();    //stop form from submitting
    if (!isValueValid(this.customer_id))
         return;
    if (this.fastly_key.value != "") {
       if (!isValueValid(this.fastly_key))
            return;
     }
       
    if (this.svc_id_to.value < this.svc_id_from.value) {
         google.script.run.showAlert("Please enter valid \"To\" date greater than \"From\" date");
         return;
    }
    
    if (parseInt(this.svc_no_to.value) < parseInt(this.svc_no_from.value)) {
    //google.script.run.showAlert("Svc num to" + this.svc_no_to.value);
    //google.script.run.showAlert("Svc num from" + this.svc_no_from.value);
    google.script.run.showAlert("The \"To\" " + this.svc_no_to.value + " Service number must be greater than \"From\" " + this.svc_no_from.value + " Service number");
    return;
    }
    
    if (((this.svc_id_to.value == "" || this.svc_id_to.value == 0) && (this.svc_id_from.value != "" || this.svc_id_from.value != 0)) || ((this.svc_id_to.value != "" || this.svc_id_to.value != 0) && (this.svc_id_from.value == "" || this.svc_id_from.value == 0))) {
         google.script.run.showAlert("Please enter valid from and to date ranges or leave them blank");
         return;
    } else if ((this.svc_id_to.value == "" || this.svc_id_to.value == 0) && (this.svc_id_from.value == "" || this.svc_id_from.value == 0)) {
             this.svc_id_to.value = 0;
             this.svc_id_from.value = 0;
    }
    
    
    google.script.run.getMeCustInfo(this);
     //google.script.host.close();//close this dialogbox
    }
    );
    </script>
  </body>
</html>